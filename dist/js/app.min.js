$(document).ready(function()
{

	// Gestion des tailles
	//
	// var taille1 = 185;
	// var taille2 = 165;
	//
	// $('.p:nth-child(1)').find('.taille').text(taille1);
	// $('.p:nth-child(2)').find('.taille').text(taille2);
	//
	// $('.p:nth-child(1)').css('height', function() {
	// 	return ((taille1 - 5) * 100) / 225 + "%";
	// });
	//
	// $('.p:nth-child(2)').css('height', function() {
	// 	return ((taille2 - 5) * 100) / 225 + "%";
	// });
	//
	// $('.p:nth-child(1) img').css('height', function() {
	// 	return (taille1 * 25) / 225 + "%";
	// });
	//
	// $('.p:nth-child(2) img').css('height', function() {
	// 	return (taille2 * 25) / 225 + "%";
	// });



	$(".close").css("display", "none");
	$(".close-help").css("display", "none");

	var isMenuOpen = false;
	var isHelpOpen = false;
	var isAddOpen = false;
	var isAddRwdOpen = false;



	$('.menu_btn').click(function()
	{
		if (isMenuOpen === false)
		{
		//alert('je suis dans le bon cas')
			$("#menu").clearQueue().animate({
				left : '0'
			});

			$(".close").fadeIn(300);

			isMenuOpen = true;
		}
	});

	$('.close').click(function()
	{
		if (isMenuOpen === true)
		{
			$("#menu").clearQueue().animate({
				left : '-240px'
			});

			$(this).fadeOut(200);

			isMenuOpen = false;
		}
	});

  $('.close-add').click(function()
	{
		if (isAddOpen === false)
		{
			$(this).clearQueue().animate({
				width : '55px',
				left: '-55px'
			});
			$("#admin").clearQueue().animate({
				right : '0'
			});
			$('#admin').find('.icn-admin').removeClass('icon-add-man').addClass('icon-close-bold');
			$('#admin').find('.txt-admin').hide();

			isAddOpen = true;
		}
		else if (isAddOpen === true)
		{
			$(this).clearQueue().animate({
				width : '160px',
				left: '-160px'

			});
			$("#admin").clearQueue().animate({
				right : '-280px'
			});
			$('#admin').find('.icn-admin').addClass('icon-add-man').removeClass('icon-close-bold');
			$('#admin').find('.txt-admin').show();


			isAddOpen = false;
		}
	});

	$('.close-rwd').click(function()
	{
		if (isAddRwdOpen === false)
		{
			$(this).clearQueue().animate({
				width : '55px'
			});
			$("#admin-rwd").clearQueue().animate({
				top : '0'
			});
			$('#admin-rwd').find('.icn-admin').removeClass('icon-add-man').addClass('icon-close-bold');
			$('#admin-rwd').find('.txt-admin').hide();

			isAddRwdOpen = true;
		}
		else if (isAddRwdOpen === true)
		{
			$(this).clearQueue().animate({
				width : '160px'

			});
			$("#admin-rwd").clearQueue().animate({
				top : '-380px'
			});
			$('#admin-rwd').find('.icn-admin').addClass('icon-add-man').removeClass('icon-close-bold');
			$('#admin-rwd').find('.txt-admin').show();


			isAddRwdOpen = false;
		}
	});

	$('.help_btn').click(function()
	{
		if (isHelpOpen === false)
		{
		//alert('je suis dans le bon cas')
			$("#help").clearQueue().animate({
				right : '0'
			});

			$(".close-help").fadeIn(300);

			isHelpOpen = true;
		}
	});

	$('.close-help').click(function()
	{
		if (isHelpOpen === true)
		{
			$("#help").clearQueue().animate({
				right : '-240px'
			});

			$(this).fadeOut(200);

			isHelpOpen = false;
		}
	});

});

(function(){

  "use strict";

  angular.module('ruler', ['ngRoute', 'ui.bootstrap', 'ui.bootstrap.typeahead'])
        .controller('persosCtrl', persosCtrl)
        .controller('addCtrl', addCtrl)
        .filter('selectById', function(){
          return function(input, id){

            var out = [];

              angular.forEach(input, function(user){
                if(id.includes(user.id)){
                  out.push(user);
                }
              });


            return out;
          };
        })
        .factory('UsersMgmt', function($rootScope) {
          return {
            propagation: function(users) {
              $rootScope.$broadcast('TransfertUsers', users);
            },
            propagationFiltres: function(nomModel, valeurModele) {
              $rootScope.$broadcast(nomModel, valeurModele);
            }
          };

        });

  function persosCtrl($scope, $http, UsersMgmt){

    console.log("Scope Charg√©e");

    $scope.customGender = true;

    if (sessionStorage.getItem("ssCompare") === null) {
      $scope.persoSelected = [];
    } else {
      $scope.persoSelected  = JSON.parse(sessionStorage.getItem("ssCompare"));
    }


    $http.get("dist/datas/data.json").
          success(function(data, status) {
            console.log('JSON Gen : ', data);
          	$scope.persos = data;
            if ($.inArray(9999, $scope.persoSelected) !== -1)
            {
              $scope.persos.push(JSON.parse(sessionStorage.getItem("ssCustom")));
            }
            $scope.tabAutoComplete = [];
            for (var i = 0; i < $scope.persos.length; i++) {
              $scope.tabAutoComplete.push($scope.persos[i].firstname + " " + $scope.persos[i].lastname);
            }
          });

    $scope.ngModelOptionsSelected = function(value) {
      if (arguments.length) {
        _selected = value;
      } else {
        return _selected;
      }
    };

    $scope.modelOptions = {
      debounce: {
        default: 500,
        blur: 250
      },
      getterSetter: true
    };

    $scope.addPerso = function(){

      var idArray = $scope.tabAutoComplete.indexOf($scope.selected);

      if (idArray !== -1 && $scope.persoSelected.indexOf(idArray) === -1) {
        $scope.persoSelected.push(idArray);
      }

      $scope.selected = "";

      sessionStorage.setItem("ssCompare",JSON.stringify($scope.persoSelected));

    };

    $scope.addCustomPerso = function(isValid){

      if (isValid) {

        var index = $scope.persos.findIndex(function(item, i){
          return item.id === 9999;
        });

        var size = 175;
        if (parseInt($scope.customSize) >= 80 && parseInt($scope.customSize) <= 225)
        {
            size = parseInt($scope.customSize);
        }


        var customAvatar = {
          "id": 9999,
          "firstname": "",
          "lastname": $scope.customFirstName,
          "gender": !$scope.customGender,
          "picture": "blank.png",
          "size": size
        };

        if (index !== -1)
        {
          $scope.persos.splice(index, 1);
        }

        $scope.persos.push(customAvatar);
        $scope.persoSelected.push(9999);

        $scope.customSize = "";
        $scope.customFirstName = "";
        $scope.customGender = true;

        console.log($scope.persos);
        console.log($scope.persoSelected);

        sessionStorage.setItem("ssCompare",JSON.stringify($scope.persoSelected));
        sessionStorage.setItem("ssCustom",JSON.stringify(customAvatar));
      }

    };

    $scope.deletePerso = function(id){

      var index = $scope.persoSelected.indexOf(id);
      $scope.persoSelected.splice(index, 1);

      sessionStorage.setItem("ssCompare",JSON.stringify($scope.persoSelected));

    };

  }

  function addCtrl($scope, UsersMgmt){


  }


}());

//# sourceMappingURL=app.min.js.map
